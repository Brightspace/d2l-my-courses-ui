<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../d2l-siren-parser/d2l-siren-parser.html">
<link rel="import" href="../d2l-ajax/d2l-ajax.html">
<link rel="import" href="d2l-alert.html">
<link rel="import" href="d2l-all-courses-styles.html">
<link rel="import" href="d2l-course-tile.html">
<link rel="import" href="d2l-course-tile-region-behavior.html">
<link rel="import" href="localize-behavior.html">
<link rel="import" href="d2l-interaction-detection-behavior.html">
<link rel="import" href="d2l-course-management-behavior.html">

<dom-module id="d2l-all-courses">
	<template>
		<style include="d2l-all-courses-styles"></style>

		<div class="dialog-content">
			<h3 class="d2l-heading-3">{{localize('pinnedCourses')}}</h3>
			<d2l-alert visible="{{!_hasPinnedCourses}}">
				{{localize('noPinnedCoursesMessage')}}
			</d2l-alert>
			<div class="my-courses-container" role="region">
				<template is="dom-repeat" items="[[pinnedCoursesEntities]]">
					<d2l-course-tile
						enrollment="[[item]]"
						hover-enabled="[[_hoverInteractionEnabled]]"
						touch-enabled="[[_touchInteractionEnabled]]"
						animate-insertion="[[removeCourseFromTransitionList(item.properties.id)]]">
					</d2l-course-tile>
				</template>
			</div>

			<h3 class="d2l-heading-3">{{localize('unpinnedCourses')}}</h3>
			<div class="my-courses-container" role="region">
				<template is="dom-repeat" items="[[unpinnedCoursesEntities]]">
					<d2l-course-tile
						enrollment="[[item]]"
						hover-enabled="[[_hoverInteractionEnabled]]"
						touch-enabled="[[_touchInteractionEnabled]]"
						animate-insertion="[[removeCourseFromTransitionList(item.properties.id)]]">
					</d2l-course-tile>
				</template>
			</div>
		</div>
	</template>

	<script>
		Polymer({
			is: 'd2l-all-courses',
			behaviors: [
				Polymer.D2L.MyCourses.CourseTileRegionBehavior,
				Polymer.D2L.MyCourses.LocalizeBehavior,
				Polymer.D2L.MyCourses.InteractionDetectionBehavior,
				Polymer.D2L.MyCourses.CourseManagementBehavior
			],
			focusableNodesOverride: function() {
				var courseTileFocusables = [];

				Polymer.dom(this.root).querySelectorAll('d2l-course-tile').forEach(function(courseTile) {
					Array.prototype.push.apply(courseTileFocusables, Polymer.dom(courseTile.root).querySelectorAll('a'));
				});

				return courseTileFocusables;
			},
			_getOverlayWidth: function() {
				return this._getAvailableWidth(this.$$('.dialog-content'));
			},
			get courseTileItemCount() {
				var itemCount = Math.max(this.pinnedCoursesEntities.length, this.unpinnedCoursesEntities.length);

				return itemCount;
			}
		});
	</script>
</dom-module>
